<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>使用GOST搭建一个简单的端口转发</title>
    <link href="/2022/11/06/%E4%BD%BF%E7%94%A8GOST%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/"/>
    <url>/2022/11/06/%E4%BD%BF%E7%94%A8GOST%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><strong>Gost</strong>是一个功能多样且实用的安全隧道工具，使用的是<strong>go</strong>语言编写<br><strong>GitHub项目：</strong><a href="https://github.com/ginuerzh/gost">https://github.com/ginuerzh/gost</a><br><strong>Gost文档：</strong><a href="https://docs.ginuerzh.xyz/gost">https://docs.ginuerzh.xyz/gost</a><br><strong>Gost搭建Socks5：</strong><a href="https://sunpma.com/862.html">https://sunpma.com/862.html</a></p><h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul><li>多端口监听</li><li>可设置转发代理，支持多级转发(代理链)</li><li>支持标准HTTP&#x2F;HTTPS&#x2F;HTTP2&#x2F;SOCKS4(A)&#x2F;SOCKS5代理协议</li><li>Web代理支持探测防御</li><li>支持多种隧道类型</li><li>SOCKS5代理支持TLS协商加密</li><li>Tunnel UDP over TCP</li><li>TCP&#x2F;UDP透明代理</li><li>本地&#x2F;远程TCP&#x2F;UDP端口转发</li><li>支持Shadowsocks(TCP&#x2F;UDP)协议</li><li>支持SNI代理</li><li>权限控制</li><li>负载均衡</li><li>路由控制</li><li>DNS解析和代理</li><li>TUN&#x2F;TAP设备</li></ul><h2 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">X64<br>wget <span class="hljs-string">&quot;https://github.com/ginuerzh/gost/releases/download/v2.8.1/gost_2.8.1_linux_amd64.tar.gz&quot;</span><br><br>tar -zxvf gost_2.<span class="hljs-number">8.1</span>_linux_amd64.tar.gz<br><br>mv gost_2.<span class="hljs-number">8.1</span>_linux_amd64<span class="hljs-regexp">/gost /u</span>sr<span class="hljs-regexp">/bin/g</span>ost<br><br>chmod +x <span class="hljs-regexp">/usr/</span>bin/gost<br>复制代码<br></code></pre></td></tr></table></figure><p><code>ARM</code>（比如甲骨文<code>ARM</code>机型）</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget <span class="hljs-string">&quot;https://github.com/ginuerzh/gost/releases/download/v2.8.1/gost_2.8.1_linux_arm.tar.gz&quot;</span><br><br>tar -zxvf gost_2.<span class="hljs-number">8.1</span>_linux_arm.tar.gz<br><br>mv gost_2.<span class="hljs-number">8.1</span>_linux_arm<span class="hljs-regexp">/gost /u</span>sr<span class="hljs-regexp">/bin/g</span>ost<br><br>chmod +x <span class="hljs-regexp">/usr/</span>bin/gost<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>TCP 转发</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">gost -L=tcp:<span class="hljs-regexp">//</span>:本地使用端口/远程服务IP:远程服务端口<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>UDP 转发</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">gost -L=udp:<span class="hljs-regexp">//</span>:本地使用端口/远程服务IP:远程服务端口<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>全协议转发（TCP+UDP）</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">gost <span class="hljs-attribute">-L</span>=:本地使用端口/远程服务IP:远程服务端口<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>小飞机转发</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">gost <span class="hljs-attribute">-L</span>=:本地使用端口 <span class="hljs-attribute">-F</span>=ss://加密方式:密码@远程服务IP:远程服务端口?nodelay=true<br>复制代码<br></code></pre></td></tr></table></figure><p>示例：使用A服务器的<code>8888</code>端口转发IP为<code>114.114.114.114</code>的B服务器的<code>9999</code>端口（TCP+UDP）<br><code>gost -L=:8888/114.114.114.114:9999</code><br>创建命令后我们就可以连接到A服务器的<code>8888</code>端口，从而使用B服务器的<code>9999</code>端口；<br>如果服务器使用了宝塔面板需要在面板安全设置中放行对应的端口；</p><p>如果测试后没有问题，就可以使用<code>nohup</code>命令将转发设置挂载到后台持续运行；<br><code>nohup</code>命令重启后会失效，开机后再次挂载即可重新使用；<br><strong>挂载后台</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">nohup gost -L=:本地使用端口/远程服务IP:远程服务端口 &gt; <span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>关闭挂载</strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">kill -<span class="hljs-number">9</span> <span class="hljs-constructor">$(<span class="hljs-params">ps</span> <span class="hljs-params">aux</span> | <span class="hljs-params">grep</span> <span class="hljs-string">&quot;gost&quot;</span> | <span class="hljs-params">sed</span> &#x27;<span class="hljs-operator">/</span><span class="hljs-params">grep</span><span class="hljs-operator">/</span><span class="hljs-params">d</span>&#x27; | <span class="hljs-params">awk</span> &#x27;&#123;<span class="hljs-params">print</span> $2&#125;&#x27;)</span><br>复制代码<br></code></pre></td></tr></table></figure><h2 id="Windows安装"><a href="#Windows安装" class="headerlink" title="Windows安装"></a>Windows安装</h2><p>首先下载需要的<code>Windows</code>版本程序：<a href="https://github.com/ginuerzh/gost/releases">https://github.com/ginuerzh/gost/releases</a><br>压缩包解压后将得到的<code>exe</code>后缀文件移动到<code>C</code>盘根目录下<br>然后打开系统<code>CMD(命令提示符)</code>输入以下命令开始运行：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 切换到C盘根目录</span><br>cd /<br><br><span class="hljs-comment"># 开始转发</span><br>gost-windows-amd64.exe -L=tcp:<span class="hljs-regexp">//</span>:本地使用端口/远程服务IP:远程服务端口<br><br><span class="hljs-comment"># 其中gost-windows-amd64.exe为移动到C盘根目录下的程序名称，如有不同自行修改；</span><br>复制代码<br></code></pre></td></tr></table></figure><h2 id="iptables-一键脚本"><a href="#iptables-一键脚本" class="headerlink" title="iptables 一键脚本"></a>iptables 一键脚本</h2><p>如果不想使用GOST，也可以选择使用iptables来转发，这里推荐一个233大佬的端口转发一键脚本；<br><strong>安装</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget -N --no-check-certificate https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/sunpma/</span>doubi<span class="hljs-regexp">/master/i</span>ptables-pf.sh &amp;&amp; chmod +x iptables-pf.sh &amp;&amp; bash iptables-pf.sh<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>管理</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs markdown">./iptables-pf.sh<br> iptables 端口转发一键管理脚本 [v1.1.1]<br>  <br><span class="hljs-bullet"> 0.</span> 升级脚本<br>————————————<br><span class="hljs-bullet"> 1.</span> 安装 iptables<br><span class="hljs-bullet"> 2.</span> 清空 iptables 端口转发<br>————————————<br><span class="hljs-bullet"> 3.</span> 查看 iptables 端口转发<br><span class="hljs-bullet"> 4.</span> 添加 iptables 端口转发<br><span class="hljs-bullet"> 5.</span> 删除 iptables 端口转发<br>————————————<br>注意：初次使用前请请务必执行 1. 安装 iptables(不仅仅是安装)<br><br> 请输入数字 [0-5]:<br>复制代码<br></code></pre></td></tr></table></figure><p><strong>添加转发时依次输入落地端IP、落地端口、本地端口、本地内网IP、转发类型；</strong><br><strong>注意：填写本机IP时是填写本地内网IP地址，而非外网IP地址，查看本地内网IP地址可以使用<code>ifconfig</code>命令；</strong><br><a href="https://sunpma.com/usr/uploads/2020/10/3120166323.png"><img src="https://s.imgkb.xyz/abcdocker/2022/11/06/29204226b4b64/29204226b4b64.png" alt="img"></a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
